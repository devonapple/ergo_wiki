# How to set up and configure a full Ergo node

This tutorial explains how to install and configure an Ergo node.

## Node security

There are a few important aspects of node usage that your wallet and money's safety depends on:
* An Ergo node requires storing security-critical parameters in the configuration file. You should never make this file public.
* An Ergo node provides a REST API for interacting with the built-in wallet. Sensitive API methods require a security token, which should never be sent over untrusted channels.

## Setting up the environment

To run an Ergo node you need JRE version >= 8 to be installed. One way to install it is to use [Oracle implementation of Java](https://www.oracle.com/technetwork/java/javase/downloads/index.html).

## Setting up an Ergo node

When the environment is ready it is time to download the latest [Ergo client release](https://github.com/ergoplatform/ergo/releases/) and create a configuration file.
All parameters are described in the [default configuration file](https://github.com/ergoplatform/ergo/blob/master/src/main/resources/application.conf). In your configuration file, you only need to rewrite parameters that you want to change from the default values. As an example, you can check the [sample configuration file](https://github.com/ergoplatform/ergo/blob/master/src/main/resources/nodeTestnet/application.conf) for the latest testnet which contains only the important parameters.

Let ºs now take a few important steps:

1. **Setting an API key**: For configuring the wallet, you must first configure the `apiKeyHash` parameter in the node configuration file as described [here](https://github.com/ergoplatform/ergo/wiki/Ergo-REST-API#setting-an-api-key):

   `scorex.restApi.apiKeyHash = "replace_this_with_your_unique_api_key_hash"`

   The hash is the hex-encoded Blake2b256 hash of your secret phrase that will be used to authenticate your API requests. You can use this [script](https://gist.github.com/oskin1/704ef3fba8d40bb1e7691919bf1e9cf9/) or any other script to calculate blake2b hash for this purpose. The secret phrase can be any random string but please ensure that this remains secret and is not sent to any untrusted services. 

   The following REST API endpoint also provides a (non-protected) method to compute this:

   [`/utils/hashBlake2b`](http://127.0.0.1:9052/swagger#/utils/hashBlake2b)

2. **Initialize the wallet**: This step requires an API key to have been set as described above. When running the node for the first time, the wallet needs to be initialized via the REST API. Two options are available for this: 
    * Initialize it from scratch (seed will be generated by the node) by making a POST request to `/wallet/init` with data `body: {"pass": "123", "mnemonicPass": "abc"}` (Note: don't forget to save the mnemonic phrase that the node responds with. The parameter `mnemonicPass` in request body is optional and is used for protecting the mnemonic phrase).
    * Restore the wallet from an existing seed. You will have to provide your mnemonic phrase When using this option. This is done by making a POST request to `/wallet/restore` with data `body: {"pass": "123", "mnemonic": "abandon abandon ...", "mnemonicPass": "abc"}` (Note: the `mnemonicPass` field is required only in case your mnemonic phrase was protected by an additional password at creation).

3. **Unlock the wallet**: After the wallet is initialized it needs to be unlocked by making a POST request to `/wallet/unlock` with data `body: {"pass": "123"}`. (Note: use the password you had chosen at initialization stage)

Details of wallet are described [here](https://github.com/ergoplatform/ergo/wiki/Wallet-configuration).

## Running the Ergo node

To run a node from `ergo-assembly-<version>.jar` binary and `ergo.conf` configuration file execute:
```
$ java -jar ergo-assembly-<version>.jar ergo.conf
```

To make sure the node is running, open [`127.0.0.1:9052/info`](http://127.0.0.1:9052/info) in your browser. This will return general information about your node. 

The node provides a REST API as described [here](https://github.com/ergoplatform/ergo/wiki/Ergo-REST-API).
